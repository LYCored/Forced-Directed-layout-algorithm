# Forced-Directed-layout-algorithm
The assignment of the Visualization

I have googled it and found a lot of information online, The troublesome thing is that it has a lot of extended technology, 

such as additional air resistance, gravity, and simulated annealing algorithm. there are so many things about it that can be studied but I  didn't have enough time. In the end, I chose to do the most basic part of it.

## Basic idea

the forced-directed layout algorithm is simulated force field which based on physical laws. The two most basic forces are repulsive force and spring force.

### repulsive force

We imagine each point of the scatter plot as a charge (or a celestial body). There is a repulsive force between the points like a real charge. We can use Coulomb's law to calculate it.

> F = k * (q1 * q2) / r ^ 2

In the code, for the convenience of calculation, we take *k*, *q1* and *q2* as constants 1.

### spring force

Like the repulsion force, we  treated the point  as a charge. We also consider the line between the points as a compressed spring. We can use Hooke's law to calculate it.

> F = k * Δx

In the code, for the convenience of calculation, we take *k* as constants 1, The original length of the spring needs to be defined according to the actual situation.

### Iteration

Now, we can get the resultant force at each point. We can approximate it to the velocity at each point by a certain mathematical operation, so as to obtain the offset that needs to be moved at each point.

## Optimization by Quadtree

The basic algorithm needs to calculate the repulsive force generated by other points for each point, the time complexity is O(n^2). We can use the Quadtree to optimize it.

The quadtree divides the screen into countless small squares as long as there are more than one point in the current square, then we can treat the points that satisfy certain conditions as a whole and store the calculation results in the tree.

The condition is that these points are far enough away from the target point, we use *W / d < θ* to judge whether they satisfy this condition, and *W* is the size of the subtree (we take the side length of the square), and *d* is the distance from the center of gravity of the subtree to the target point, the *θ* is a constant, we choose 0.5.

Because we calculated points as a whole block, so some of the force is stored in the nodes of the tree. We need pre-order traversal to accumulate the force in the tree to the points corresponding to the leaf nodes. In addition, when we calculate the repulsive force on the target node, we should multiply the weight of the subtree.
